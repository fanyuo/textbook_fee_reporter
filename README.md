# 教材购书费用计算与统计程序

---

**文件名称**: `TextbookPurchaseFeeCalculator.py`  
**作者**: 樊彧  
**创建日期**: 2025-09-20  
**最后修改**: 2025-09-20  

---

## 📌 程序说明
本程序基于 **PyQt5** 图形界面，结合 **pandas** 库对 Excel 数据进行处理，  
可自动读取 **书商售书单** 与 **学生购书记录**，对指定班级的学生购书费用进行 **自动计算与统计**。  
统计结果通过 **三栏 HTML 表格** 在界面中美化展示，并可导出为 **Excel** 或 **TXT** 文件，便于财务核对和数据存档。

---

## 🔹 主要功能
1. **数据读取**：读取并解析书商售书单（教材与价格）及学生购书记录。  
2. **班级筛选**：按输入的班级名称筛选对应学生数据。  
3. **智能匹配**：自动匹配教材名称与价格，支持多种模糊匹配算法。  
4. **费用统计**：计算每位学生的购书总额，并进行班级总额汇总。  
5. **可视化展示**：在三栏界面中美观呈现：
   - 📚 教材清单  
   - 👩‍🎓 学生购书记录  
   - 💰 学生购书费用清单  
6. **多格式导出**：支持将统计结果导出为 **Excel**（推荐）或 **TXT** 格式。  
7. **用户体验优化**：
   - 自动记忆上次选择的文件路径与班级名称  
   - 大窗口布局，列宽优化，查看体验更好  

---

## 📖 使用说明

### 1. 准备数据文件
请准备两个 Excel 文件，并确保列名与程序要求一致：  
- **书商售书单**：需包含列 `"序号"`、`"教材名称"`、`"折扣价"`  
- **学生购书记录**：需包含列 `"姓名"`、`"班级"`、`"教材名称"`  

### 2. 运行程序
- 在命令行进入程序目录：
  ```bash
  python TextbookPurchaseFeeCalculator.py
