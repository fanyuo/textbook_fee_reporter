# 教材购书费用计算与统计程序

## 项目简介
本项目是北京建筑大学的教材购书费用计算与统计程序，用于自动化处理学生购书记录与教材价格信息，生成详细的统计报表，方便班级教材费用的核对和管理。

## 功能说明
1. 从Excel文件中读取教材销售数据和学生购书记录
2. 自动匹配学生购买的教材与价格信息
3. 计算每个学生的购书总费用
4. 生成详细的统计报表，包括：
   - 教材清单
   - 学生购书记录
   - 学生购书费用明细
   - 总金额统计

## 使用说明

### 环境要求
- Python 3.x
- 依赖库：
  - pandas
  - openpyxl

安装依赖：
```bash
pip install pandas openpyxl
```

### 文件准备
1. 准备两个Excel文件：
   - 教材销售文件（书商提供）
   - 学生购书记录文件（教务系统导出）
2. 确保文件包含必要的列：
   - 教材销售文件：序号、教材名称、折扣价
   - 学生购书记录：姓名、班级、教材名称

### 运行程序
修改以下变量后运行程序：
```python
BOOK_SALES_FILE = "./书商售书单-在校生2025-2026学年第1学期教材统计表.xlsx"
STUDENT_RECORDS_FILE = "./教务系统导出-在校生及2025年专升本同学-2025-2026学年第1学期教材统计表.xlsx"
TARGET_CLASS = "电气231"
```

运行命令：
```bash
python textbook_fee_reporter.py
```

### 输出说明
程序将输出以下信息：
1. 教材清单：列出所有教材及其价格
2. 学生购书记录：显示每个学生购买的教材
3. 学生购书费用：每个学生的购书总金额
4. 总计金额：班级教材总费用

## 匹配算法说明
当教材名称不完全匹配时，程序采用以下算法进行匹配：
1. 原始名称匹配（完全相同的教材名称）
2. 去除空格和括号后的匹配（保留括号内内容）
3. 去除括号及括号内内容后的匹配
4. 去除所有非字母数字和中文字符后的匹配

## 注意事项
1. 请确保Excel文件格式正确，列名与程序定义一致
2. 运行程序后，请仔细核对输出结果
3. 如程序输出结果与文件记录存在差异，最终以文件中记录的金额为准
4. 程序计算结果仅供参考，请务必人工核对

## 免责声明
作者不对因使用本程序而导致的任何直接或间接损失承担责任。
